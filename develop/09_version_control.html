<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-11-30">

<title>RDM for NGS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../img/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">RDM for NGS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../develop/01_RDM_intro.html" aria-current="page"> 
<span class="menu-text">Course material</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../use_cases.html"> 
<span class="menu-text">Use cases</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/hds-sandbox"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/company/ucph-heads/"> <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../develop/09_version_control.html">Data analysis version control</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/01_RDM_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Fundamentals</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/02_NGS_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Next Generation Sequencing Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/03_data_life_cycle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Life Cycle</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/04_OS_FAIR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Open Science and FAIR principles</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/05_DMP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Management Plans</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/06_file_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Best Practices for Data Storage</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/07_metadata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Metadata for NGS data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/08_database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating a data catalog</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/09_version_control.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Data analysis version control</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../develop/10_repos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Repositories for NGS</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#version-control-of-your-data-analysis-using-git-and-github" id="toc-version-control-of-your-data-analysis-using-git-and-github" class="nav-link active" data-scroll-target="#version-control-of-your-data-analysis-using-git-and-github">Version control of your data analysis using Git and Github</a>
  <ul class="collapse">
  <li><a href="#version-control" id="toc-version-control" class="nav-link" data-scroll-target="#version-control">Version control</a></li>
  <li><a href="#git-and-github" id="toc-git-and-github" class="nav-link" data-scroll-target="#git-and-github">Git and Github</a>
  <ul class="collapse">
  <li><a href="#version-control-using-git" id="toc-version-control-using-git" class="nav-link" data-scroll-target="#version-control-using-git">Version control using Git</a></li>
  <li><a href="#hosting-your-git-repos-using-github" id="toc-hosting-your-git-repos-using-github" class="nav-link" data-scroll-target="#hosting-your-git-repos-using-github">Hosting your git repos using Github</a></li>
  </ul></li>
  <li><a href="#creating-a-repo-from-your-project-folder" id="toc-creating-a-repo-from-your-project-folder" class="nav-link" data-scroll-target="#creating-a-repo-from-your-project-folder">Creating a repo from your Project folder</a>
  <ul class="collapse">
  <li><a href="#creating-a-git-repo-from-an-existing-folder" id="toc-creating-a-git-repo-from-an-existing-folder" class="nav-link" data-scroll-target="#creating-a-git-repo-from-an-existing-folder">Creating a git repo from an existing folder</a></li>
  <li><a href="#creating-a-git-repo-online-and-copying-your-project-folder" id="toc-creating-a-git-repo-online-and-copying-your-project-folder" class="nav-link" data-scroll-target="#creating-a-git-repo-online-and-copying-your-project-folder">Creating a git repo online and copying your project folder</a></li>
  </ul></li>
  <li><a href="#github-pages" id="toc-github-pages" class="nav-link" data-scroll-target="#github-pages">GitHub Pages</a></li>
  <li><a href="#a-full-setup-example" id="toc-a-full-setup-example" class="nav-link" data-scroll-target="#a-full-setup-example">A full setup example</a>
  <ul class="collapse">
  <li><a href="#install-all-required-tools-and-software" id="toc-install-all-required-tools-and-software" class="nav-link" data-scroll-target="#install-all-required-tools-and-software">Install all required tools and software</a></li>
  <li><a href="#create-your-own-github-account" id="toc-create-your-own-github-account" class="nav-link" data-scroll-target="#create-your-own-github-account">Create your own GitHub account</a></li>
  <li><a href="#create-a-github-organization-for-your-lab-or-department" id="toc-create-a-github-organization-for-your-lab-or-department" class="nav-link" data-scroll-target="#create-a-github-organization-for-your-lab-or-department">Create a GitHub organization for your lab or department</a></li>
  <li><a href="#configure-your-main-github-page-and-its-repo" id="toc-configure-your-main-github-page-and-its-repo" class="nav-link" data-scroll-target="#configure-your-main-github-page-and-its-repo">Configure your main GitHub Page and its repo</a></li>
  <li><a href="#make-a-repo-for-your-cookiecutter-template" id="toc-make-a-repo-for-your-cookiecutter-template" class="nav-link" data-scroll-target="#make-a-repo-for-your-cookiecutter-template">Make a repo for your cookiecutter template</a></li>
  <li><a href="#start-a-new-project-from-cookiecutter" id="toc-start-a-new-project-from-cookiecutter" class="nav-link" data-scroll-target="#start-a-new-project-from-cookiecutter">Start a new project from cookiecutter</a></li>
  <li><a href="#publishing-your-project-as-a-github-page" id="toc-publishing-your-project-as-a-github-page" class="nav-link" data-scroll-target="#publishing-your-project-as-a-github-page">Publishing your project as a GitHub Page</a></li>
  </ul></li>
  <li><a href="#wrap-up" id="toc-wrap-up" class="nav-link" data-scroll-target="#wrap-up">Wrap up</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data analysis version control</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 30, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 5, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<!--
# Put above to hide navigation (left), toc (right) or footer (bottom)

hide:
  - navigation 
  - toc
  - footer 

# You should hide the navigation if there are no subsections
# You should hide the Table of Contents if there are no important titles
-->
<section id="version-control-of-your-data-analysis-using-git-and-github" class="level1">
<h1>Version control of your data analysis using Git and Github</h1>
<div class="callout callout-style-default callout-note callout-titled" title="Course Overview">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Course Overview
</div>
</div>
<div class="callout-body-container callout-body">
<p>⏰ <strong>Time Estimation:</strong> X minutes<br>
💬 <strong>Learning Objectives:</strong><br>
1. Learn what is version control and why it is important 2. Introduce you to Git and Github repositories 3. Make your own repositories 4. Make a Github page to show off your data analysis reports</p>
</div>
</div>
<p>In this lesson, we will explore the concept of version control and its role in modern research and development workflows. We’ll introduce Git, a widely adopted version control system that allows you to systematically track changes in your work. Additionally, we will check GitHub, a collaborative platform for hosting Git repositories, enabling you to share your work with others and increase the visibility of your projects. By the end of this lesson, you’ll have a introductory understanding of version control, the ability to create Git repositories, and the skills to build a GitHub page to showcase your data analysis.</p>
<section id="version-control" class="level2">
<h2 class="anchored" data-anchor-id="version-control">Version control</h2>
<p>Version control is a systematic approach to tracking changes made to a project over time. It provides a structured means of documenting alterations, allowing you to revisit and understand the evolution of your work. In research data management and data analytics, version control is very important and gives you a lot of advantages.</p>
<p>!!! success “Advantages of using version control”</p>
<pre><code>1. **Document Progress**: Version control keeps a detailed history of changes, making it easier to understand how a project has developed, what modifications were made, and by whom.
2. **Ensure Data Integrity**: It safeguards data by preventing accidental overwrites or deletions. Each change is tracked, enabling easy recovery in case of errors.
3. **Facilitate Collaboration**: In collaborative research, version control enables multiple team members to work simultaneously on a project without conflicts. Changes can be merged seamlessly.
4. **Reproducibility**: It enhances reproducibility by preserving the exact state of your project at any point in time. This is invaluable for validating research findings and data analysis.
5. **Branching and Experimentation**: Version control allows for branching, where you can create alternative versions of your project for experimentation without affecting the main branch.
6. **Global Accessibility**: Platforms like GitHub provide global visibility, allowing researchers to share their work, receive feedback, and contribute to open science.</code></pre>
</section>
<section id="git-and-github" class="level2">
<h2 class="anchored" data-anchor-id="git-and-github">Git and Github</h2>
<p>!!! warning</p>
<pre><code>In this section we will only talk briefly about what is Git and Github. Explaining how git works is beyond the scope of this course. If you want to know more, please check out our [course](https://heads.ku.dk/course/git_github/)! You can also check [GitHub documentation](https://docs.github.com/get-started), which cover all the basics to work with Git and GitHub.</code></pre>
<section id="version-control-using-git" class="level3">
<h3 class="anchored" data-anchor-id="version-control-using-git">Version control using Git</h3>
<p><a href="https://git-scm.com/about">Git</a> is a distributed version control system that enables developers and researchers to efficiently manage their project’s history, collaborate seamlessly, and ensure data integrity. At its core, Git operates through the following principles and mechanisms:</p>
<ol type="1">
<li><strong>Local Repository</strong>: Each user maintains a local repository on their computer, allowing them to work on a project independently. This local repository stores the complete project history.</li>
<li><strong>Snapshots, Not Files</strong>: Git does not track individual file changes but rather captures snapshots of the entire project at different points in time. This ‘snapshot’ approach ensures data consistency.</li>
<li><strong>Commits</strong>: Users create ‘commits,’ which are snapshots of the project at a specific moment. Commits record changes made to files, along with a commit message explaining the modifications.</li>
<li><strong>Branching</strong>: Git supports branching, enabling users to create separate lines of development. Branches are useful for experimenting with new features or fixing bugs without affecting the main project.</li>
<li><strong>Merging</strong>: Changes made in one branch can be merged into another, allowing for the incorporation of new features or bug fixes back into the main project. Git ensures a smooth merging process.</li>
<li><strong>Distributed Architecture</strong>: Git’s distributed nature means that each user’s local repository is a complete copy of the project, including its entire history. This enables offline work and ensures data redundancy.</li>
<li><strong>Remote Repositories</strong>: Git allows users to connect and synchronize their local repositories with remote repositories hosted on platforms like GitHub. Remote repositories facilitate collaboration and provide a central hub for project sharing.</li>
<li><strong>Push and Pull</strong>: Users ‘push’ their local changes to a remote repository to share with others. Conversely, they ‘pull’ changes made by others into their local repository to stay up-to-date.</li>
<li><strong>Conflict Resolution</strong>: In cases of conflicting changes, Git provides tools to resolve conflicts manually, ensuring that data integrity is maintained during collaboration.</li>
<li><strong>Versioning and Tagging</strong>: Git offers versioning and tagging capabilities, allowing users to mark specific points in history, such as major releases or significant milestones.</li>
</ol>
</section>
<section id="hosting-your-git-repos-using-github" class="level3">
<h3 class="anchored" data-anchor-id="hosting-your-git-repos-using-github">Hosting your git repos using Github</h3>
<p>On the other hand, <a href="https://github.com/">GitHub</a> is a web-based platform that enhances Git’s capabilities by providing a collaborative and centralized hub for hosting Git repositories. It offers several key functionalities, such as tracking issues, security features to safeguard your repos, and GitHub Pages that allows you to create websites to showcase your projects. We will see more about Github Pages in the section below. In addition, you can set your repository as <strong>private</strong> until you are ready to publish your work!</p>
<p>If you do not have an account in Github already, we recommend you to do one now! There are other alternatives to GitHub, such as <a href="https://bitbucket.org/">BitBucket</a> and <a href="https://about.gitlab.com/">GitLab</a>, Some features might be different, so we will stick to Github for the rest of the lesson!</p>
</section>
</section>
<section id="creating-a-repo-from-your-project-folder" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-repo-from-your-project-folder">Creating a repo from your Project folder</h2>
<p>We will show you two ways to make your <code>Project</code> folder into a Git repository</p>
<p>!!! warning “What about my Assay folder?”</p>
<pre><code>An assay folder contains very big files that are not suitable for version control, at least in GitHub. We recommend that you deposit the data into a domain specific archive such as [GEO](https://www.ncbi.nlm.nih.gov/geo/) or [ArrayExpress/Annotare](https://www.ebi.ac.uk/fg/annotare/login/). Even [Zenodo](https://zenodo.org/) would be a better option in this case. We will look at them in the [next session](./10_repos.qmd).

Remember to link the original dataset with the data analysis repository!</code></pre>
<section id="creating-a-git-repo-from-an-existing-folder" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-git-repo-from-an-existing-folder">Creating a git repo from an existing folder</h3>
<p>Using <a href="https://docs.github.com/en/migrations/importing-source-code/using-the-command-line-to-import-source-code/adding-locally-hosted-code-to-github"><code>git init</code></a> is probably the right choice for you if you have created a <code>Project</code> folder using the cookiecutter template we saw in the <a href="../develop/06_file_structure.html">previous lesson</a>.</p>
<p>The <code>git init</code> command should only be run once, even if other collaborators share will the project!</p>
<ul>
<li>First, initialize the repository (<code>git init</code>) and make at least one commit (<code>git add</code> and <code>git commit</code>).</li>
<li>Once you have initialized the repository, create a remote repository in <a href="https://github.com/">GitHub</a></li>
<li>Then, add the remote URL to your local git repository with <code>git remote add origin \&lt;URL\&gt;</code>. This stores the remote URL under a more human-friendly name, origin.</li>
<li>Shape your history into at least one commit by using <code>git add</code> to stage the existing files, and <code>git commit</code> to make the snapshot.</li>
<li>Once you have at least one commit, you can push to the remote and set up the tracking relationship for good with <code>git push -u origin master</code>.</li>
</ul>
</section>
<section id="creating-a-git-repo-online-and-copying-your-project-folder" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-git-repo-online-and-copying-your-project-folder">Creating a git repo online and copying your project folder</h3>
<p>If the repository already exists on a remote, you would choose to <code>git clone</code> and not <code>git init</code>. On the other hand, if you create a remote repository first with the intent of moving your project to it later, you may have a few other steps to follow. If there are no commits in the remote repository, you can follow the steps above for <code>git init</code>. If there are commits and files in the remote repository but you would still like it to contain your project files, <code>git clone</code> that repository. Then, move the project’s files into that cloned repository. <code>git add</code>, <code>git commit</code>, and <code>git push</code> to create a history that makes sense for the beginning of your project. Then, your team can interact with the repository without <code>git init</code> again.</p>
<p>!!! tip “Tips to write good commit messages”</p>
<pre><code>If you would like to know more about Git commits and the best way to make clear git messages, check out [this post](https://www.conventionalcommits.org/en/v1.0.0/)!</code></pre>
</section>
</section>
<section id="github-pages" class="level2">
<h2 class="anchored" data-anchor-id="github-pages">GitHub Pages</h2>
<p>Once you have created your repository (and put it in GitHub), you have now the opportunity to add your data analysis reports that you created, in either Jupyter Notebooks, Rmarkdowns or html reports, in a <a href="https://pages.github.com/">GitHub Page website</a>. Creating a GitHub page is very simple, and we really recommend that you follow the nice tutorial that GitHub as put for you.</p>
<p>There are many different ways to create your webpages. We recommend using Mkdocs and Mkdocs materials as a framework to create a nice webpage in a simple manner. The folder templates that we used as an example in <a href="../develop/06_file_structure.html">lesson 06</a> already contain everything you need to start a webpage. Nonetheless, you will need to understand the basics of <a href="https://www.mkdocs.org/">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">MkDocs materials</a> to design a webpage to your liking. MkDocs is a static webpage generator that is very easy to use, while MkDocs materials is an extension of the tool that gives you many more options to customize your website. Check out their webpages to get started!</p>
</section>
<section id="a-full-setup-example" class="level2">
<h2 class="anchored" data-anchor-id="a-full-setup-example">A full setup example</h2>
<p>In this section we will showcase a full example about how to setup Git, MkDocs and a github account so you can do it yourself!</p>
<section id="install-all-required-tools-and-software" class="level3">
<h3 class="anchored" data-anchor-id="install-all-required-tools-and-software">Install all required tools and software</h3>
<p>There are several tools and softwares that you need to install. First you will need <code>pip</code> and install the following packages using pip in the command line:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install cookiecutter <span class="co"># cookiecutter to create folder templates</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install cruft <span class="co"># cruft is used to version control your templates</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mkdocs <span class="co"># mkdocs to create your webpages</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mkdocs-material <span class="co"># mkdocs extension to customize your templates</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mkdocs-video <span class="co"># mkdocs extension to add videos or embed internet videos, like youtube, to your webpages</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mkdocs-bibtex <span class="co"># mkdocs extension to add references in your text from a bib file</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install neoteroi-mkdocs <span class="co"># mkdocs extension to create author cards</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mkdocs-minify-plugin <span class="co"># mkdocs extension to minimize the html code created by mkdocs</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mkdocs-git-revision-date-localized-plugin  <span class="co"># mkdocs extension to show "last updated" date of your webpage</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mkdocs-jupyter <span class="co"># mkdocs extension to include jupyter notebooks without needing to convert them</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install mkdocs-table-reader-plugin <span class="co"># mkdocs extension to embed tabular format files like tsv or csv</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Lastly and very importantly, install Git from their <a href="https://git-scm.com/downloads">webpage</a>.</p>
</section>
<section id="create-your-own-github-account" class="level3">
<h3 class="anchored" data-anchor-id="create-your-own-github-account">Create your own GitHub account</h3>
<p>Go to <a href="https://github.com/">Github</a> and create a new user.</p>
</section>
<section id="create-a-github-organization-for-your-lab-or-department" class="level3">
<h3 class="anchored" data-anchor-id="create-a-github-organization-for-your-lab-or-department">Create a GitHub organization for your lab or department</h3>
<p>GitHub allows users to create organizations and teams that will collaborate together or create repositories under the same umbrella organization. If you would like to create an educational organization in GitHub, you can do so for free! For example, you could create a GitHub account for your lab.</p>
<p>In order to create a GitHub organization, follow these <a href="https://docs.github.com/en/organizations/collaborating-with-groups-in-organizations/creating-a-new-organization-from-scratch">instructions</a></p>
<p>After you have created the GitHub organization, make sure that you create your repositories under the organization space and not your own user!</p>
</section>
<section id="configure-your-main-github-page-and-its-repo" class="level3">
<h3 class="anchored" data-anchor-id="configure-your-main-github-page-and-its-repo">Configure your main GitHub Page and its repo</h3>
<p>The next step is to set up the main GitHub Page site and the repository that will host it. This is very simple, as you will only need to follow <a href="https://pages.github.com/">these steps</a>.</p>
<p>After you have created the <em>organization</em>github.io, it is time to configure your webpage using MkDocs!</p>
<section id="use-mkdocs-to-create-your-webpage" class="level4">
<h4 class="anchored" data-anchor-id="use-mkdocs-to-create-your-webpage">Use mkdocs to create your webpage</h4>
<p>Follow the steps on the <a href="https://www.mkdocs.org/getting-started/">MkDocs documentation</a> to get started on your webpage! You can use a simple markdown file describing your organization (your lab or department), its main goals and missions and maybe a couple of images showcasing your research.</p>
<p>When you are happy with your webpage and are ready too publish it, make sure to add, commit and push the changes to the remote! Instead of using the basic setup that GitHub offers, we recommend that you build up your webpage using MkDocs and the <a href="https://www.mkdocs.org/user-guide/deploying-your-docs/"><code>mkdocs gh-deploy</code></a> command! This requires a couple of changes in your GitHub organization settings.</p>
</section>
<section id="publishing-your-github-page" class="level4">
<h4 class="anchored" data-anchor-id="publishing-your-github-page">Publishing your GitHub Page</h4>
<p>Go to your GitHub organization settings and configure the Page section. Since you are using the <code>mkdocs gh-deploy</code> command to publish your site in the <code>gh-pages</code> branch (as explained the the mkdocs documentation), we need to change where GitHub is fetching the website from:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/git_pages.png" class="img-fluid figure-img"></p>
<figcaption>GitHub Pages setup</figcaption>
</figure>
</div>
<ul>
<li>Branch should be <code>gh-pages</code></li>
<li>Folder should be <code>root</code></li>
</ul>
<p>After a couple of minutes, your webpage should be ready!</p>
</section>
</section>
<section id="make-a-repo-for-your-cookiecutter-template" class="level3">
<h3 class="anchored" data-anchor-id="make-a-repo-for-your-cookiecutter-template">Make a repo for your cookiecutter template</h3>
<p>Your GitHub organization account and webpage is ready! Now it is time to create a cookiecutter template for your folders using what you learned in this <a href="../develop/06_file_structure.html">lesson</a>.</p>
</section>
<section id="start-a-new-project-from-cookiecutter" class="level3">
<h3 class="anchored" data-anchor-id="start-a-new-project-from-cookiecutter">Start a new project from cookiecutter</h3>
<p>Using cookiecutter, create a new data analysis project. Remember to fill up your metadata and description files! After you have created the folder, it would be best to initialize a Git repo following the instructions from the <a href="#creating-a-git-repo-from-an-existing-folder">previous section</a>.</p>
<p>Next, link your data of interest and make an example of data analysis notebook/report. Depending on your setup, you might be using Jupyter Notebooks or Rmarkdowns. The extensions that we have installed using <code>pip</code> allows you to directly add a Jupyter Notebook file to the <code>mkdocs.yml</code> navigation section. On the other hand, if you are using Rmarkdown, you will have to knit your document into either an html page or a github document.</p>
</section>
<section id="publishing-your-project-as-a-github-page" class="level3">
<h3 class="anchored" data-anchor-id="publishing-your-project-as-a-github-page">Publishing your project as a GitHub Page</h3>
<p>Remember to make sure that your markdowns, images, reports, etc., are included in the <code>docs</code> folder and properly set up in the navigation section of your <code>mkdocs.yml</code> file.</p>
<p>Git add, commit and push your changes. Then, run <code>mkdocs gh-deploy</code>. You will still need to configure the settings of this repositories in GitHub, so that the Page is taken from the <code>gh-pages</code> branch and the <code>root</code> folder. You should be able to see your webpage through the link provided in the Page section!</p>
<p>Now it is also possible to include this repository webpage in your main webpage <em>organization</em>github.io by including the link of the repo website (https://<em>organization</em>github.io/<em>repo-name</em>) in the navigation section of the <code>mkdocs.yml</code> file in the main <em>organization</em>github.io repo.</p>
<p>!!! question “Exercise 5: make a project folder and publish a data analysis webpage”</p>
<pre><code>1. Configure your main GitHub Page and its repo

The first step is to set up the main GitHub Page site and the repository that will host it. This is very simple, as you will only need to follow [these steps](https://pages.github.com/).
After you have created the *organization/username*github.io, it is time to configure your `Project` repository webpage using MkDocs!

2. Start a new project from cookiecutter or use one from the previous exercise.

If you use a `Project` repo from the first exercise, go to the next paragraph. Using cookiecutter, create a new data analysis project. Remember to fill up your metadata and description files! After you have created the folder, it would be best to initialize a Git repo following the instructions from the [previous section](#creating-a-git-repo-online-and-copying-your-project-folder).

Next, link your data of interest (or create a small fake dataset) and make an example of data analysis notebook/report (this could be just a scatter plot of a random matrix of values). Depending on your setup, you might be using Jupyter Notebooks or Rmarkdowns. The extensions that we have installed using `pip` allows you to directly add a Jupyter Notebook file to the `mkdocs.yml` navigation section. On the other hand, if you are using Rmarkdown, you will have to knit your document into either an html page or a github document.

For the purposes of this exercise, we have already included a basic `index.md` markdown file that can serve as the intro page of your repo, and a `jupyter_example.ipynb` with some code in it. You are welcome to modify them further to test them out!

3. Use MkDocs to create your webpage

When you are happy with your files and are ready too publish them, make sure to add, commit and push the changes to the remote. Then, build up your webpage using MkDocs and the [`mkdocs gh-deploy`](https://www.mkdocs.org/user-guide/deploying-your-docs/) command from the same directory where the `mkdocs.yml` file is. For example, if your `mkdocs.yml` for your `Project` folder is in `/Users/JARH/Projects/project1_JARH_20231010/mkdocs.yml`, do `cd /Users/JARH/Projects/project1_JARH_20231010/` and then `mkdocs gh-deploy`.

Finally, we only need to set up the GitHub `Project` repo settings.

4. Publishing your GitHub Page

Go to your GitHub repo settings and configure the Page section. Since you are using the `mkdocs gh-deploy` command to publish your site in the `gh-pages` branch (as explained the the mkdocs documentation), we need to change where GitHub is fetching the website from:

![GitHub Pages setup](./images/git_pages.png)

- Branch should be `gh-pages`
- Folder should be `root`

After a couple of minutes, your webpage should be ready!</code></pre>
</section>
</section>
<section id="wrap-up" class="level2">
<h2 class="anchored" data-anchor-id="wrap-up">Wrap up</h2>
<p>In this lesson we have learned about version control and how we can use Git and GitHub to create data analyses repositories from your <code>Project</code> folders. We have also seen how one can create a GitHub organization and use GitHub Pages to display your data analyses scripts and notebooks for the general public! In the next lesson we will learn about where to archive the raw NGS data (and its metadata), as well as archiving your GitHub repositories.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>